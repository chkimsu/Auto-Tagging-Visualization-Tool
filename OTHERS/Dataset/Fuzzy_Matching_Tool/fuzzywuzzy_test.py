from fuzzywuzzy import fuzz
from fuzzywuzzy import process
import pandas as pd

taglist = pd.read_csv("/data01/justinjang87/ATVT/Dataset/out.csv", converters={i: str for i in range(0, 100)})
print(taglist)

new_c = taglist.loc[:,'object_description']
print(new_c)

# taglist = pd.read_csv("Dataset/Fuzzy_Matching_Tool/taglist.csv", converters={i: str for i in range(0, 100)})
a = ["discharge air temperature sensor",
"discharge air humidity sensor",
"discharge air pressure sensor",
"discharge air flow sensor",
"discharge air fan cmd",
"discharge air fan sensor",
"return air temperature sensor",
"return air humidity sensor",
"return air pressure sensor",
"return air flow sensor",
"return air co2 sensor",
"return air fan cmd",
"return air damper cmd",
"mixed air temperature sensor",
"outside air temperature sensor",
"outside air humidity sensor",
"outside air pressure sensor",
"outside air flow sensor",
"outside air flow sp",
"outside air damper cmd",
"exhaust air fan cmd",
"exhaust air damper cmd",
"cool stage cmd",
"heat stage cmd",
"humidifier cmd",
"filter sensor",
"freezeStat sensor",
"heatWheel cmd",
"faceBypass cmd",
"bypass damper cmd",
"bypass damper cmd",
"zone air temperature sensor",
"zone air temperature effective sp",
"zone air temperature occ cooling sp",
"zone air temperature occ heating sp",
"zone air temperature unocc cooling sp",
"zone air temperature unocc heating sp",
"zone air temperature standby cooling sp",
"zone air temperature standby heating sp",
"zone air humidity sensor",
"zone air co2 sensor",
"zone air co2 sp",
]
#
b = []
#
# c = ["15th floor mechanical room",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Compartment Unit Temp",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Return Air CO2 Sensor D",
# "Return Air CO2",
# "Supply Air Temperature",
# "South West Corner",
# "North East Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Outdoor Air Flow",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Return Air CO2 Sensor D",
# "Return Air CO2",
# "Supply Air Temperature",
# "South West Corner",
# "North East Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Outdoor Air Flow",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Return Air CO2 Sensor D",
# "Return Air CO2",
# "*** OFF SET OF 1 DEG ** Sensor replaced",
# "South West Corner",
# "North East Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Outdoor Air Flow",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "Zone 1 Temperature",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Return Air CO2 Sensor D",
# "Return Air CO2",
# "Supply Air Temperature",
# "South West Corner",
# "North East Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Outdoor Air Flow",
# "Discharge Air Velocity Pressure",
# "Discharge Air Velocity Pressure",
# "Discharge Air Velocity Pressure",
# "Discharge Air Velocity Pressure",
# "Discharge Air Velocity Pressure",
# "Discharge Air Velocity Pressure",
# "Outdoor Air Flow",
# "Return Air CO2",
# "Return Air CO2 Sensor D",
# "North East Corner",
# "South West Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Supply Air Temperature",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Zone 1 Temperature",
# "Outdoor Air Flow",
# "Return Air CO2",
# "Return Air CO2 Sensor D",
# "North East Corner",
# "South West Corner",
# "West Electrical Room",
# "Compartment Unit Temp",
# "Floor Static Pressure 1",
# "Floor Static Pressure 2",
# "Supply Air Temperature",
# "Return Air CO2 Sensor A",
# "Return Air CO2 Sensor B",
# "Return Air CO2 Sensor C",
# "Zone Quality",
# "Zone 4 Quality",
# "Zone 1 Temperature",
# "Zone2 Temperature",
# "3rd Floor AC Room High Temp Alarm",
# "Zone2 Temperature",
# "Zone Temperature",
# "Zone Temperature",
# "Zone Temperature",
# "Zone Temperature",
# "Zone Temperature",
# "Zone Temperature"
# ]


finaldata = pd.DataFrame(columns=('rawdata', 'label'), index=range(20))
print("before_finaldata:", finaldata)

for i in range(20):
    for j in range(41):
        print(a[j])
        b.append(fuzz.ratio(new_c[i], a[j]))
    finaldata.loc[i, 'rawdata'] = new_c[i]
    finaldata.loc[i, 'label'] = a[b.index(max(b))]
    b.clear()

# print("after_finaldata:", finaldata)
finaldata.to_csv("new_testhere.csv", encoding='utf-8-sig')

#
# finaldata = pd.DataFrame(columns=('rawdata', 'label'), index=range(121))
# print("before_finaldata:", finaldata)
#
# for i in range(20):
#     for j in range(41):
#         print(a[j])
#         b.append(fuzz.ratio(c[i], a[j]))
#     finaldata.loc[i, 'rawdata'] = c[i]
#     finaldata.loc[i, 'label'] = a[b.index(max(b))]
#     b.clear()
#
# # print("after_finaldata:", finaldata)
# finaldata.to_csv("testhere.csv", encoding='utf-8-sig')
#
